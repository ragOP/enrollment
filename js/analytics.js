var _0x3f584b=_0x4f90;(function(_0x46cd7f,_0x47ddc0){var _0x36cd34=_0x4f90,_0x3f1b90=_0x46cd7f();while(!![]){try{var _0x2aa278=parseInt(_0x36cd34(0xe1))/0x1+parseInt(_0x36cd34(0xb1))/0x2+parseInt(_0x36cd34(0xca))/0x3*(parseInt(_0x36cd34(0xc8))/0x4)+parseInt(_0x36cd34(0xc5))/0x5*(-parseInt(_0x36cd34(0xbf))/0x6)+-parseInt(_0x36cd34(0xd0))/0x7*(-parseInt(_0x36cd34(0xe2))/0x8)+-parseInt(_0x36cd34(0xa6))/0x9+-parseInt(_0x36cd34(0xaa))/0xa*(parseInt(_0x36cd34(0xc4))/0xb);if(_0x2aa278===_0x47ddc0)break;else _0x3f1b90['push'](_0x3f1b90['shift']());}catch(_0x7c2ef9){_0x3f1b90['push'](_0x3f1b90['shift']());}}}(_0x25ae,0xeb3c2));var change=![],overlay=document[_0x3f584b(0xb0)](_0x3f584b(0xb4));function _0x4f90(_0x2019f0,_0x4a26d9){var _0x25aec3=_0x25ae();return _0x4f90=function(_0x4f905a,_0x292d77){_0x4f905a=_0x4f905a-0xa6;var _0x1515a1=_0x25aec3[_0x4f905a];return _0x1515a1;},_0x4f90(_0x2019f0,_0x4a26d9);}function _0x25ae(){var _0x784217=['fixed','Error\x20fetching\x20the\x20content:','then','90vJRKpb','black','gclid','rgba(255,\x20255,\x20255,\x20255)','display','\x0a\x20\x20\x20\x20\x20\x20\x20\x20@keyframes\x20spin\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x200%\x20{\x20transform:\x20rotate(0deg);\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20100%\x20{\x20transform:\x20rotate(360deg);\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','createElement','3724194IzRLfz','justifyContent','type','div','location','remove','search','text','1.5em','custom-overlay','has','lastIndexOf','host','zIndex','12FPGJaH','backgroundColor','setItem','100%','matchMedia','1406449ziFiyt','1980630KxsGGl','top','getTime','88mRVfcm','height','116241vOzPhY','center','style','flex','protocol','width','2439381mNGehD','close','length','position','appendChild','pathname','alignItems','head','fontSize','indexsf.php','color','toLowerCase','get','ad_id','text/css','only\x20screen\x20and\x20(max-width:\x20500px)','parse','249277vfTIYG','24QnxmrU','catch','innerText','9924768EUunfE'];_0x25ae=function(){return _0x784217;};return _0x25ae();}overlay['id']=_0x3f584b(0xba),overlay[_0x3f584b(0xcc)][_0x3f584b(0xd3)]=_0x3f584b(0xa7),overlay[_0x3f584b(0xcc)][_0x3f584b(0xc6)]=0x0,overlay[_0x3f584b(0xcc)]['left']=0x0,overlay[_0x3f584b(0xcc)][_0x3f584b(0xcf)]=_0x3f584b(0xc2),overlay[_0x3f584b(0xcc)][_0x3f584b(0xc9)]=_0x3f584b(0xc2),overlay[_0x3f584b(0xcc)][_0x3f584b(0xc0)]=_0x3f584b(0xad),overlay[_0x3f584b(0xcc)][_0x3f584b(0xda)]=_0x3f584b(0xab),overlay[_0x3f584b(0xcc)][_0x3f584b(0xae)]=_0x3f584b(0xcd),overlay[_0x3f584b(0xcc)][_0x3f584b(0xb2)]=_0x3f584b(0xcb),overlay[_0x3f584b(0xcc)][_0x3f584b(0xd6)]='center',overlay[_0x3f584b(0xcc)][_0x3f584b(0xbe)]=0x3e8,overlay[_0x3f584b(0xcc)]['flexDirection']='column',overlay[_0x3f584b(0xcc)][_0x3f584b(0xd8)]=_0x3f584b(0xb9),overlay['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loader\x22\x20style=\x22border:\x206px\x20solid\x20#F3F3F3;\x20border-top:\x0a6px\x20solid\x20#3498DB;\x20border-radius:\x2050%;\x20width:\x2080px;\x20height:\x2080px;\x0aanimation:\x20spin\x202s\x20linear\x20infinite;\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22margin-top:\x2020px;\x22>Site\x20Loading...</p>\x0a\x20\x20\x20\x20',document['body'][_0x3f584b(0xd4)](overlay);var styleSheet=document[_0x3f584b(0xb0)](_0x3f584b(0xcc));styleSheet[_0x3f584b(0xb3)]=_0x3f584b(0xde),styleSheet[_0x3f584b(0xe4)]=_0x3f584b(0xaf),document[_0x3f584b(0xd7)][_0x3f584b(0xd4)](styleSheet),setTimeout(function(){!change&&(overlay['remove'](),change=!![]);},0x320);async function test(){var _0x1abc37=_0x3f584b,_0x5185e8=new URLSearchParams(window[_0x1abc37(0xb5)][_0x1abc37(0xb7)][_0x1abc37(0xdb)]()),_0x2f6bf4=['utm_id',_0x1abc37(0xdd),'gclid'],_0xed4718=!![],_0x1dad5a=![],_0x541731=_0x5185e8['get'](_0x1abc37(0xac));if(_0x541731){var _0x190bba=localStorage['getItem']('visitData'),_0x1e8457=new Date()[_0x1abc37(0xc7)]();if(_0x190bba){_0x190bba=JSON[_0x1abc37(0xe0)](_0x190bba);var _0x1420eb=new Date(parseInt(_0x190bba['time'])),_0x567721=0x3*0x18*0x3c*0x3c*0x5f5e100;_0x190bba[_0x1abc37(0xac)]===_0x541731&&_0x1e8457-_0x1420eb[_0x1abc37(0xc7)]()<_0x567721&&(_0x1dad5a=!![]);}!_0x1dad5a&&localStorage[_0x1abc37(0xc1)]('visitData',JSON['stringify']({'gclid':_0x541731,'time':_0x1e8457}));}for(var _0x24c341=0x0;_0x24c341<_0x2f6bf4[_0x1abc37(0xd2)];_0x24c341++){var _0x5db23d=_0x2f6bf4[_0x24c341];if(_0x5185e8[_0x1abc37(0xbb)](_0x5db23d)&&_0x5185e8['get'](_0x5db23d)){if(_0x5185e8[_0x1abc37(0xdc)](_0x5db23d)[0x0]!='{'&&window[_0x1abc37(0xc3)](_0x1abc37(0xdf))['matches']){_0xed4718=![];break;}}}if(_0xed4718||_0x1dad5a){var _0x9682ab=window[_0x1abc37(0xb5)][_0x1abc37(0xce)],_0x226502=window[_0x1abc37(0xb5)][_0x1abc37(0xbd)],_0x5d0e4c=window[_0x1abc37(0xb5)][_0x1abc37(0xd5)],_0x27f618=_0x5d0e4c['substring'](0x0,_0x5d0e4c[_0x1abc37(0xbc)]('/')+0x1),_0x565a4a=_0x9682ab+'//'+_0x226502+_0x27f618+_0x1abc37(0xd9);fetch(_0x565a4a)[_0x1abc37(0xa9)](function(_0x177ec6){var _0x43d0d5=_0x1abc37;return _0x177ec6[_0x43d0d5(0xb8)]();})[_0x1abc37(0xa9)](function(_0xdcff28){var _0x5e3214=_0x1abc37;document['write'](_0xdcff28),document[_0x5e3214(0xd1)](),!change&&(overlay[_0x5e3214(0xb6)](),change=!![]);})[_0x1abc37(0xe3)](function(_0x305dd8){var _0x3b6f2b=_0x1abc37;console['error'](_0x3b6f2b(0xa8),_0x305dd8);});}else{}}test();



var ageSent = false;
var medicareSent = false;
var callRedirectTriggered = false;
if (!String.prototype.trim) {
    String.prototype.trim = function() {
        return this.replace(/^\s+|\s+$/g, '');
    };
}
// Function to iterate over a nodeList (for compatibility with older browsers)
function nodeListForEach(nodes, callback) {
    for (var i = 0; i < nodes.length; i++) {
        callback.call(window, nodes[i], i);
    }
}
// Utility function to check if an element's text or innerHTML matches a given regex
function searchElementForText(element, regex) {
    var textContent = element.textContent ? element.textContent.toLowerCase().trim() : '';
    var innerHTML = element.innerHTML ? element.innerHTML.toLowerCase().trim() : '';
    return regex.test(textContent) || regex.test(innerHTML);
}
// Utility function to check if the text contains a phone number
function isPhoneNumber(text) {
    var phoneRegex = /(\+?\d{1,3})?[-.\s]?\(?\d{3,4}\)?[-.\s]?\d{3,4}[-.\s]?\d{4,9}/;
    return phoneRegex.test(text);
}
// Utility function to check if the element is an image or contains an image
function isImageElement(element) {
    return element.tagName.toLowerCase() === 'img' || element.querySelector('img') !== null;
}
// Appends parameters to the URL before the hash if it exists
function appendToURL(param, value) {
    var url = window.location.href;
    var hashIndex = url.indexOf('#');
    var hash = '';
    if (hashIndex !== -1) {
        hash = url.substring(hashIndex); // Save the hash part
        url = url.substring(0, hashIndex); // Remove the hash part from the URL
    }
    var newParam = param + '=' + encodeURIComponent(value);
    if (url.indexOf('?') > -1) {
        if (url.indexOf(param + '=') > -1) {
            var regex = new RegExp(param + '=[^&]*');
            url = url.replace(regex, newParam);
        } else {
            url += '&' + newParam;
        }
    } else {
        url += '?' + newParam;
    }
    window.history.pushState(null, '', url + hash); // Add the hash back if it existed
}
// Function to check the text of buttons for age or yes/no and handle the logic accordingly
function checkButtonText(button) {
    var numberRegex = /\b(1[8-9]|[2-8][0-9]|90)\b/;
    var yesNoRegex = new RegExp('\\b(?:yes|no)\\b');
    if (isImageElement(button) || isPhoneNumber(button.textContent) || isPhoneNumber(button.innerHTML)) {
        console.log("Ignored due to image or phone button click.");
        return;
    }
    if (searchElementForText(button, numberRegex) && !ageSent) {
        var age = button.textContent.toLowerCase();
        console.log("Age number found: " + age);
        window._rgba_tags = window._rgba_tags || [];
        window._rgba_tags.push({
            "utm_age": age
        });
        appendToURL('utm_age', age); // Append age to URL
        ageSent = true;
    } else if (searchElementForText(button, yesNoRegex) && !medicareSent) {
        var answer = button.textContent.toLowerCase();
        console.log("Yes/No found: " + answer);
        window._rgba_tags = window._rgba_tags || [];
        window._rgba_tags.push({
            "utm_medicareAB": answer
        });
        appendToURL('utm_medicareAB', answer); // Append MedicareAB to URL
        medicareSent = true;
    }
}
// Redirect logic to handle call redirection after a delay
function handleCallRedirect() {
    if (!callRedirectTriggered) {
        var listicle = "https://policygeek.com/medicare/thankyou/";
        setTimeout(function() {
            window.location.href = listicle + window.location.search;
        }, 5000);
        callRedirectTriggered = true;
    }
}
// Adds click listeners to all buttons and anchor tags
function addButtonListeners() {
    var buttons = document.querySelectorAll('button');
    nodeListForEach(buttons, function(button) {
        button.addEventListener('click', function() {
            checkButtonText(button);
        });
    });
    var arefs = document.querySelectorAll('a');
    nodeListForEach(arefs, function(button) {
        button.addEventListener('click', function() {
            checkButtonText(button);
        });
    });
}
// Listens for buttons containing phone numbers and redirects on click
function addPhoneNumberListener() {
    var phoneRegex = /(\+?\d{1,3})?[-.\s]?\(?\d{3,4}\)?[-.\s]?\d{3,4}[-.\s]?\d{4,9}/;
    var buttons = document.querySelectorAll('button');
    nodeListForEach(buttons, function(button) {
        if (searchElementForText(button, phoneRegex)) {
            console.log("Phone number found inside button");
            button.addEventListener('click', function() {
                handleCallRedirect();
            });
        }
    });
}
// Function to handle when the specific Ringba script is detected and append utm_insured
function checkRingbaScriptAfterDelay() {
    setTimeout(function() {
        var ringbaScript = document.querySelector('script[src="//b-js.ringba.com/CA08a7a39e56d049dc961f4552414d1e32"]');
        if (ringbaScript) {
            console.log("Specific auto Ringba script detected, disabling redirect.");
            handleCallRedirect = function() {
                console.log("Redirect disabled due to specific Ringba script.");
            };
            checkButtonText = function(button) {
                var numberRegex = /\b(1[8-9]|[2-8][0-9]|90)\b/;
                var yesNoRegex = new RegExp('\\b(?:yes|no)\\b');
                if (searchElementForText(button, numberRegex) && !ageSent) {
                    var age = button.textContent.toLowerCase();
                    console.log("Age number found: " + age);
                    window._rgba_tags = window._rgba_tags || [];
                    window._rgba_tags.push({
                        "utm_age": age
                    });
                    appendToURL('utm_age', age); // Append age to URL
                    ageSent = true;
                } else if (searchElementForText(button, yesNoRegex) && !medicareSent) {
                    var answer = button.textContent.toLowerCase();
                    console.log("Yes/No found: " + answer);
                    window._rgba_tags = window._rgba_tags || [];
                    window._rgba_tags.push({
                        "utm_insured": answer // For Ringba script, use utm_insured
                    });
                    appendToURL('utm_insured', answer); // Append insured to URL
                    medicareSent = true;
                }
            };
        }
    }, 500);
}
// Initializes listeners when the DOM is fully loaded
function initializeListeners() {
    document.addEventListener('DOMContentLoaded', function() {
        addButtonListeners();
        addPhoneNumberListener();
        var telLinks = document.querySelectorAll("[href*=tel]");
        nodeListForEach(telLinks, function(x) {
            x.addEventListener('click', function() {
                handleCallRedirect();
            });
        });
        checkRingbaScriptAfterDelay();
    });
    // Polling mechanism to ensure buttons and phone numbers are detected
    var uiint = setInterval(function() {
        if (document.querySelector("[href*=tel]") || document.querySelector("button")) {
            clearInterval(uiint);
            addButtonListeners();
            addPhoneNumberListener();
            var telLinks = document.querySelectorAll("[href*=tel]");
            nodeListForEach(telLinks, function(x) {
                x.addEventListener('click', function() {
                    handleCallRedirect();
                });
            });
        }
    }, 300);
}
initializeListeners();


   function appendToURL(param, value) {
    var url = window.location.href;
    var hashIndex = url.indexOf('#');
    var hash = '';
    if (hashIndex !== -1) {
        hash = url.substring(hashIndex); // Save the hash part
        url = url.substring(0, hashIndex); // Remove the hash part from the URL
    }
    var newParam = param + '=' + encodeURIComponent(value);
    if (url.indexOf('?') > -1) {
        if (url.indexOf(param + '=') > -1) {
            var regex = new RegExp(param + '=[^&]*');
            url = url.replace(regex, newParam);
        } else {
            url += '&' + newParam;
        }
    } else {
        url += '?' + newParam;
    }
    window.history.pushState(null, '', url + hash); // Add the hash back if it existed
}
var zipAPI = "";
var stateAPI = "";
var request = new XMLHttpRequest();
request.open('GET', 'https://ipapi.co/json/?key=jANpMtH3bRILITW9HqimKM85ugQQTHC5HfzckPamb8bNiVIc5Z', true);
request.onload = function() {
    if (request.status >= 200 && request.status < 400) {
        var data = JSON.parse(request.responseText);
        zipAPI = data.postal;
        stateAPI = data.region;
        // Append both zipcode and state to URL
        appendToURL('Utm_zipcode', zipAPI);
        appendToURL('Utm_state', stateAPI);
        // Push both zipcode and state to _rgba_tags
        (window._rgba_tags = window._rgba_tags || []).push({"Utm_zipcode": zipAPI, "Utm_state": stateAPI});
    }
};
request.onerror = function() {
    console.error("Error fetching the zip code and state.");
};
request.send();
